<%- include('../partials/header.ejs', { page: 'access' }) %>

<script>
	function verifyAction() {
		var domain = event.target.elements['domain'].value || '';
		var question = 'Do you want to do this action?';

		switch (event.submitter && event.submitter.name) {
			case 'action_remove': question = 'Do you really want to remove ' + domain + '?'; break;
			case 'action_edit': return;
			case 'action_clone': return;
		}
		if (!window.confirm(question)) {
			event.preventDefault();
		}
	}
</script>

<div class="mt-3 mb-2 d-flex flex-column flex-md-row align-items-center">
	<h1 class="h2 mr-md-auto m-0">Website management</h1>
	<a href="/admin/edit-website" class="btn btn-outline-primary"><span class="fas fa-plus"></span> Add website</a>
</div>

<table class="table table-striped table-sm data-table">
	<thead>
		<tr>
			<th>Domain</th>
			<th>Type</th>
			<th>Repository</th>
			<th>Actions</th>
		</tr>
	</thead>
	<tbody>
		<% for (let site of sites) { %>
			<tr>
				<td><%=site.domain %></td>
				<td><%=site.proxyType %></td>
				<td><%=site.repository %></td>
				<td>
					<form method="post" onsubmit="verifyAction()">
						<input type="hidden" name="_csrf" value="<%=csrfToken %>">
						<input type="hidden" name="id" value="<%=site.id%>" />
						<input type="hidden" name="domain" value="<%=site.domain%>" />
						<button type="submit" name="action_edit" class="action-button fas fa-pen" title="Edit site"></button>
						<button type="submit" name="action_clone" class="action-button fas fa-copy" title="Duplicate site"></button>
						<button type="submit" name="action_remove" class="action-button fas fa-trash" title="Remove site"></button>
					</form>
				</td>
			</tr>
		<% } %>
	</tbody>
</table>

<%- include('../partials/footer.ejs') %>
